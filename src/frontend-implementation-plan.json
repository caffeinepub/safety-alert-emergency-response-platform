{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Fix role assignment error - allow users to self-select roles during registration",
  "requirements": [
    {
      "id": "REQ-14",
      "summary": "Verify that the RegistrationForm component correctly passes the selected role to the backend when creating a new user profile",
      "acceptanceCriteria": [
        "The role selected via RoleSelector is included in the profile creation request",
        "Registration completes successfully for both citizen and officer role selections",
        "Users are redirected to the appropriate dashboard based on their selected role"
      ],
      "file_operations": [
        {
          "path": "frontend/src/components/RegistrationForm.tsx",
          "operation": "modify",
          "description": "Verify that the selected role from RoleSelector is correctly passed to the backend register method. Ensure the userType parameter matches the role selection (citizen or officer) and that the registration mutation properly handles both role types without requiring special authorization. Confirm error handling displays meaningful messages if the backend returns authorization errors."
        },
        {
          "path": "frontend/src/pages/AuthPage.tsx",
          "operation": "modify",
          "description": "Verify that after successful registration, users are correctly redirected to their role-appropriate dashboard (citizen dashboard for citizens, officer dashboard for officers). Ensure the redirect logic checks the userProfile.userType field and routes accordingly. Confirm that the authentication flow properly handles the transition from registration to dashboard access."
        },
        {
          "path": "frontend/src/hooks/useQueries.ts",
          "operation": "modify",
          "description": "Verify that the useRegister mutation correctly accepts and passes the userType parameter to the backend register method. Ensure proper error handling for authorization failures and that successful registration triggers appropriate cache invalidation for user profile queries. Confirm the mutation returns success state that can be used for navigation."
        }
      ]
    }
  ]
}